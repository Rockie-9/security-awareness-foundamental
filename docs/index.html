<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Securing Our Future - GSM Training</title>

  <!-- Performance: preconnect for fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap');

    :root {
      --tech-blue: #00f3ff;
      --tech-dark: #0a0f1c;
      --tech-darker: #05080f;
      --tech-alert: #ff2a6d;
      --tech-warn: #f59e0b;
      --tech-safe: #10b981;
      --grid-color: rgba(0, 243, 255, 0.05);
    }

    /* Accessibility: honor reduced motion */
    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; scroll-behavior: auto !important; }
    }

    body {
      background-color: var(--tech-darker);
      color: #e2e8f0;
      font-family: 'Inter', sans-serif;
      /* Keep stage fixed; slides handle their own scrolling */
      margin: 0;
      height: 100vh;
      width: 100vw;
      overflow: hidden;
    }

    .bg-grid {
      background-image:
        linear-gradient(var(--grid-color) 1px, transparent 1px),
        linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
      background-size: 40px 40px;
      position: absolute;
      inset: 0;
      z-index: -1;
    }

    h1, h2, h3, .mono {
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: -0.05em;
    }

    .slide-container {
      position: relative;
      height: 100%;
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      perspective: 1000px;
    }

    .slide {
      position: absolute;
      width: 95%;
      height: 85%;
      opacity: 0;
      transform: scale(0.95) translateY(20px);
      transition: opacity 0.35s ease, transform 0.35s ease;
      pointer-events: none;
      display: flex;
      flex-direction: column;

      /* Mobile: allow slide content to scroll */
      overflow-y: auto;
      scrollbar-width: none;
      will-change: transform, opacity;
    }

    @media (min-width: 768px) {
      .slide { width: 85%; height: 75%; overflow-y: visible; }
    }

    .slide::-webkit-scrollbar { display: none; }

    .slide.active {
      opacity: 1;
      transform: scale(1) translateY(0);
      pointer-events: auto;
      z-index: 10;
    }

    .slide.active .stagger-1 { animation: fadeInUp 0.45s ease-out forwards 0.08s; opacity: 0; }
    .slide.active .stagger-2 { animation: fadeInUp 0.45s ease-out forwards 0.16s; opacity: 0; }
    .slide.active .stagger-3 { animation: fadeInUp 0.45s ease-out forwards 0.24s; opacity: 0; }
    .slide.active .stagger-4 { animation: fadeInUp 0.45s ease-out forwards 0.32s; opacity: 0; }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .glass-panel {
      background: rgba(16, 23, 42, 0.7);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(0, 243, 255, 0.15);
      box-shadow: 0 0 20px rgba(0, 243, 255, 0.05);
      transition: all 0.25s ease;
    }

    .glass-panel:hover {
      border-color: rgba(0, 243, 255, 0.3);
      box-shadow: 0 0 30px rgba(0, 243, 255, 0.1);
    }

    .scan-line {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 2px;
      background: var(--tech-blue);
      box-shadow: 0 0 10px var(--tech-blue);
      animation: scan 3s linear infinite;
      opacity: 0.5;
    }

    @keyframes scan {
      0% { top: 0%; opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { top: 100%; opacity: 0; }
    }

    /* Notes Panel: keep offscreen unless visible */
    #notes-panel {
      transform: translateY(120%);
      transition: transform 0.25s ease-in-out;
    }
    #notes-panel.visible { transform: translateY(0); }

    .hidden-script { display: none; }

    .slide-title { text-shadow: 0 0 15px rgba(0, 243, 255, 0.4); }

    /* Optional: focus visibility for keyboard users */
    :focus-visible { outline: 2px solid var(--tech-blue); outline-offset: 2px; }
  </style>
</head>

<body>
  <div class="bg-grid"></div>

  <!-- Header -->
  <header class="fixed top-0 w-full p-4 md:p-6 flex justify-between items-center z-50 text-[10px] md:text-xs tracking-widest text-slate-500 uppercase font-mono bg-slate-900/50 backdrop-blur-sm md:bg-transparent md:backdrop-filter-none border-b border-slate-800/50 md:border-none">
    <div class="flex items-center gap-2">
      <div class="p-1 bg-slate-800 rounded border border-slate-700">
        <i data-lucide="shield-check" class="text-[var(--tech-blue)] w-4 h-4 md:w-5 md:h-5"></i>
      </div>
      <span class="hidden md:inline text-slate-300">GSM // Global Security Management</span>
      <span class="md:hidden text-slate-300">GSM // Security</span>
    </div>
    <div class="flex items-center gap-4">
      <span class="text-[var(--tech-alert)] animate-pulse flex items-center gap-1 font-bold">● <span class="hidden md:inline">RESTRICTED</span></span>
      <span class="hidden md:inline opacity-60">CONFIDENTIAL</span>
    </div>
  </header>

  <!-- Main Slide Stage -->
  <main class="slide-container" id="slide-stage" aria-live="polite">
    <!-- Keep your existing slides EXACTLY as-is here -->
    <!-- ... (Slides 1–16 unchanged) ... -->

    <!-- IMPORTANT: I did not paste all slides again to keep this snippet readable.
         Apply only the JS + button changes below to your full file.
         If you want, I can return a complete single-file version with all slides included. -->
  </main>

  <!-- Footer / Controls -->
  <footer class="fixed bottom-0 w-full p-4 md:p-6 bg-slate-900/90 backdrop-blur-md border-t border-slate-800 flex justify-between items-center z-50">
    <div class="flex items-center gap-4">
      <span class="text-slate-500 font-mono text-xs md:text-sm" id="slide-counter">01 / 16</span>
    </div>

    <div class="flex gap-4" role="group" aria-label="Slide navigation">
      <button id="btn-prev" type="button"
        class="p-3 md:p-2 bg-slate-800 hover:bg-slate-700 rounded-full transition-colors text-white border border-slate-700"
        aria-label="Previous slide">
        <i data-lucide="chevron-left"></i>
      </button>
      <button id="btn-next" type="button"
        class="p-3 md:p-2 bg-slate-800 hover:bg-slate-700 rounded-full transition-colors text-white border border-slate-700"
        aria-label="Next slide">
        <i data-lucide="chevron-right"></i>
      </button>
    </div>

    <div class="flex gap-2" role="group" aria-label="View controls">
      <button id="btn-fullscreen" type="button"
        class="flex items-center gap-2 px-3 py-2 bg-slate-800 hover:bg-slate-700 rounded text-xs md:text-sm text-slate-300 transition-colors border border-slate-700"
        title="Toggle Full Screen" aria-label="Toggle full screen">
        <i data-lucide="maximize" class="w-4 h-4"></i>
        <span class="hidden md:inline">Maximize</span>
      </button>
      <button id="btn-notes" type="button"
        class="flex items-center gap-2 px-3 py-2 bg-slate-800 hover:bg-slate-700 rounded text-xs md:text-sm text-slate-300 transition-colors border border-slate-700"
        aria-controls="notes-panel" aria-expanded="false" aria-label="Toggle speaker notes">
        <i data-lucide="file-text" class="w-4 h-4"></i>
        <span class="hidden md:inline">Notes</span>
      </button>
    </div>
  </footer>

  <!-- Presenter Notes Overlay -->
  <div id="notes-panel" class="fixed bottom-[80px] md:bottom-[88px] right-2 md:right-6 left-2 md:left-auto md:w-96 bg-slate-900/95 backdrop-blur-xl border border-[var(--tech-blue)] rounded-lg shadow-2xl z-40 p-4 md:p-6 max-h-[40vh] md:max-h-64 overflow-y-auto" hidden>
    <h4 class="text-[var(--tech-blue)] text-xs font-bold uppercase tracking-widest mb-2 border-b border-slate-700 pb-2 flex items-center justify-between">
      <span>Speaker Script</span>
      <i data-lucide="mic" class="w-3 h-3"></i>
    </h4>
    <p id="current-script" class="text-slate-300 text-xs md:text-sm leading-relaxed font-mono">Loading script...</p>
  </div>

  <script>
    (() => {
      "use strict";

      const $ = (sel, root = document) => root.querySelector(sel);
      const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));

      // DOM
      const slides = $$(".slide");
      const totalSlides = slides.length;

      const scriptDisplay = $("#current-script");
      const counterDisplay = $("#slide-counter");
      const notesPanel = $("#notes-panel");
      const btnPrev = $("#btn-prev");
      const btnNext = $("#btn-next");
      const btnNotes = $("#btn-notes");
      const btnFullscreen = $("#btn-fullscreen");

      // State
      let currentSlide = 0;

      // Helpers
      const clamp = (n, min, max) => Math.min(max, Math.max(min, n));
      const pad2 = (n) => String(n).padStart(2, "0");

      function getScriptForSlide(slideEl) {
        const scriptEl = slideEl.querySelector(".hidden-script");
        return scriptEl ? scriptEl.innerText.trim() : "No speaker script for this slide.";
      }

      function setActiveSlide(nextIndex, { focusStage = false } = {}) {
        currentSlide = clamp(nextIndex, 0, totalSlides - 1);

        slides.forEach((slide, idx) => {
          slide.classList.toggle("active", idx === currentSlide);
          if (idx === currentSlide) slide.scrollTop = 0; // UX: reset scroll per slide
        });

        // Update script
        if (scriptDisplay) {
          scriptDisplay.innerText = getScriptForSlide(slides[currentSlide]);
        }

        // Counter
        if (counterDisplay) {
          counterDisplay.innerText = `${pad2(currentSlide + 1)} / ${pad2(totalSlides)}`;
        }

        // Deep link (no history spam)
        if ("replaceState" in history) {
          history.replaceState(null, "", `#slide-${currentSlide + 1}`);
        }

        // Buttons enabled state (optional clarity)
        if (btnPrev) btnPrev.disabled = currentSlide === 0;
        if (btnNext) btnNext.disabled = currentSlide === totalSlides - 1;

        if (focusStage) {
          const stage = $("#slide-stage");
          if (stage) stage.focus?.();
        }
      }

      function nextSlide() { setActiveSlide(currentSlide + 1); }
      function prevSlide() { setActiveSlide(currentSlide - 1); }

      function toggleNotes() {
        const willShow = notesPanel.hasAttribute("hidden");
        if (willShow) {
          notesPanel.removeAttribute("hidden");
          // allow layout then animate
          requestAnimationFrame(() => notesPanel.classList.add("visible"));
        } else {
          notesPanel.classList.remove("visible");
          // wait for transition then hide for a11y/tab order
          window.setTimeout(() => notesPanel.setAttribute("hidden", ""), 250);
        }

        btnNotes?.setAttribute("aria-expanded", String(willShow));
      }

      async function toggleFullScreen() {
        try {
          if (!document.fullscreenElement) {
            await document.documentElement.requestFullscreen();
          } else {
            await document.exitFullscreen();
          }
        } catch (err) {
          // Avoid alert() in training content; console is enough
          console.error("Fullscreen error:", err);
        }
      }

      // Keyboard navigation (avoid space scrolling / button activation conflicts)
      function onKeyDown(e) {
        const target = e.target;
        const isTypingContext =
          target && (target.tagName === "INPUT" || target.tagName === "TEXTAREA" || target.isContentEditable);

        if (isTypingContext) return;

        if (e.key === "ArrowRight" || e.key === "PageDown") {
          e.preventDefault();
          nextSlide();
        } else if (e.key === "ArrowLeft" || e.key === "PageUp") {
          e.preventDefault();
          prevSlide();
        } else if (e.key === " " || e.key === "Spacebar") {
          e.preventDefault();
          nextSlide();
        } else if (e.key === "Home") {
          e.preventDefault();
          setActiveSlide(0);
        } else if (e.key === "End") {
          e.preventDefault();
          setActiveSlide(totalSlides - 1);
        } else if (e.key.toLowerCase() === "n") {
          // optional: quick toggle notes
          toggleNotes();
        } else if (e.key === "Escape" && !notesPanel.hasAttribute("hidden")) {
          toggleNotes();
        }
      }

      // Touch swipe (avoid accidental swipes while scrolling vertically)
      let touchStartX = 0;
      let touchStartY = 0;
      let touchEndX = 0;
      let touchEndY = 0;

      function onTouchStart(e) {
        const t = e.changedTouches[0];
        touchStartX = t.screenX;
        touchStartY = t.screenY;
      }

      function onTouchEnd(e) {
        const t = e.changedTouches[0];
        touchEndX = t.screenX;
        touchEndY = t.screenY;

        const dx = touchEndX - touchStartX;
        const dy = touchEndY - touchStartY;

        // Horizontal swipe only if clearly horizontal
        if (Math.abs(dx) > 55 && Math.abs(dx) > Math.abs(dy) * 1.5) {
          if (dx < 0) nextSlide();
          else prevSlide();
        }
      }

      // Hash -> slide support
      function slideIndexFromHash() {
        const m = (location.hash || "").match(/^#slide-(\d+)$/);
        if (!m) return null;
        const n = Number(m[1]);
        if (!Number.isFinite(n)) return null;
        return clamp(n - 1, 0, totalSlides - 1);
      }

      // Init after DOM is ready
      function init() {
        // icons
        if (window.lucide?.createIcons) lucide.createIcons();

        // wire events (no inline onclick)
        btnPrev?.addEventListener("click", prevSlide);
        btnNext?.addEventListener("click", nextSlide);
        btnNotes?.addEventListener("click", toggleNotes);
        btnFullscreen?.addEventListener("click", toggleFullScreen);

        document.addEventListener("keydown", onKeyDown, { passive: false });
        document.addEventListener("touchstart", onTouchStart, { passive: true });
        document.addEventListener("touchend", onTouchEnd, { passive: true });

        // load slide from hash if present
        const fromHash = slideIndexFromHash();
        setActiveSlide(fromHash ?? 0);

        // if user edits hash manually
        window.addEventListener("hashchange", () => {
          const idx = slideIndexFromHash();
          if (idx !== null) setActiveSlide(idx);
        });
      }

      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>